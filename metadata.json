{
  "description": "You are working inside a strict Engine-in-React game architecture.\n\nThis codebase is NOT a typical React app.\nIt is a deterministic simulation engine orchestrated by React.\n\n────────────────────────────────────────────\nCORE ARCHITECTURAL LAW\n────────────────────────────────────────────\n\n“Simulation emits intent. Orchestrator commits reality.”\n\nYou MUST respect system ownership, frame phases, and side-effect boundaries.\nViolations are bugs, not stylistic choices.\n\n────────────────────────────────────────────\nSYSTEM OWNERSHIP (NON-NEGOTIABLE)\n────────────────────────────────────────────\n\nSimulation Systems (Hooks):\n- useMovement\n- useCombat\n- useCollisions\n- useSpawner\n- useProgression\n- useStageController\n\nSimulation systems:\n• MAY mutate their own refs\n• MAY set transient intent flags (e.g. justCompleted, shouldRemove)\n• MAY push AudioRequest objects to audioEventsRef\n• MUST NOT perform side effects\n\nSimulation systems MUST NOT:\n• Call audio.play\n• Mutate arrays via filter/splice/reassignment mid-frame\n• Read or write UI state\n• Trigger timers, effects, or rendering logic\n\n────────────────────────────────────────────\nORCHESTRATOR AUTHORITY (SnakeGame.tsx)\n────────────────────────────────────────────\n\nSnakeGame.tsx is the sole orchestrator.\n\nIt alone may:\n• Call audio.play\n• Drain audioEventsRef (single drain point)\n• Perform deferred cleanup (single end-of-frame pass)\n• Advance stages\n• Trigger UI transitions\n• Coordinate FX systems\n\nIf logic reacts to multiple systems or commits side effects,\nit belongs ONLY in the orchestrator.\n\n────────────────────────────────────────────\nFRAME PHASE ORDER (MUST BE PRESERVED)\n────────────────────────────────────────────\n\nEach frame executes in this exact order:\n\n1. Timers / cooldown decay\n2. Simulation updates (state only)\n3. Intent consumption (flags → queue / decisions)\n4. Side effects (audio, UI triggers)\n5. FX updates (visual only)\n6. Deferred entity cleanup (single pass)\n\nDO NOT:\n• Mutate shared arrays before phase 6\n• Consume intent before simulation completes\n• Trigger audio outside phase 4\n\n────────────────────────────────────────────\nAUDIO RULE (ABSOLUTE)\n────────────────────────────────────────────\n\naudio.play(...) may exist in EXACTLY ONE place:\nThe global audio drain inside SnakeGame.tsx.\n\nALL systems—including stage logic and terminal handling—\nmust emit sound via:\n\n  audioEventsRef.current.push({ type, data })\n\nDirect audio calls elsewhere are architectural violations.\n\n────────────────────────────────────────────\nENTITY LIFECYCLE RULE\n────────────────────────────────────────────\n\nSimulation systems may ONLY:\n• Mark entities with shouldRemove = true\n\nThey MUST NOT:\n• filter(), splice(), or reassign ref.current arrays\n\nThe orchestrator performs ALL cleanup in one pass at frame end.\n\n────────────────────────────────────────────\nBEFORE YOU RESPOND\n────────────────────────────────────────────\n\nBefore producing any output, you MUST:\n\n1. Identify which system owns the logic\n2. Verify frame-phase correctness\n3. Ensure no forbidden side effects occur\n4. Preserve gameplay behavior exactly\n5. Reject changes that violate ownership, even if “simpler”\n\nIf a requested change conflicts with these rules,\nyou must explain the conflict and propose a compliant alternative.\n\nThis architecture is intentional and enforced.",
  "requestFramePermissions": [],
  "name": "Neon Snake-acr"
}